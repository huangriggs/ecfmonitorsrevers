<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»æ©Ÿç›£æ§å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #0e4b99 100%);
            min-height: 100vh;
            color: #e8eaed;
            padding: 20px;
            position: relative;
            overflow-x: auto;
        }

        /* èƒŒæ™¯å‹•ç•«æ•ˆæœ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(13, 17, 23, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 35px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 35px;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #64b3f4 0%, #c2e9fb 50%, #a8e6cf 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(100, 179, 244, 0.3);
            font-weight: 700;
        }

        .header p {
            color: #a8b2d1;
            font-size: 1.1em;
            opacity: 0.9;
        }

        .diagnostic-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            margin-bottom: 35px;
        }

        .panel {
            background: linear-gradient(135deg, rgba(22, 27, 34, 0.9) 0%, rgba(13, 17, 23, 0.9) 100%);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(100, 179, 244, 0.5), transparent);
        }

        .panel-title {
            font-size: 1.4em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #e8eaed;
            border-bottom: 2px solid rgba(100, 179, 244, 0.2);
            padding-bottom: 12px;
            font-weight: 600;
        }

        .panel-content {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .panel-content.collapsed {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }

        /* é«˜è³ªæ„ŸæŒ‰éˆ•è¨­è¨ˆ */
        .btn {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: #e8eaed;
            border: 1px solid rgba(100, 179, 244, 0.2);
            padding: 14px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            margin: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            width: 100%;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(100, 179, 244, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(100, 179, 244, 0.4);
        }

        .btn:active {
            transform: translateY(-1px);
            transition: all 0.1s ease;
        }

        .btn-danger {
            background: linear-gradient(135deg, #7c2d12 0%, #dc2626 100%);
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 
                0 4px 15px rgba(220, 38, 38, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn-danger:hover {
            box-shadow: 
                0 8px 25px rgba(220, 38, 38, 0.3),
                0 0 20px rgba(239, 68, 68, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .btn-success {
            background: linear-gradient(135deg, #14532d 0%, #16a34a 100%);
            border-color: rgba(34, 197, 94, 0.3);
            box-shadow: 
                0 4px 15px rgba(22, 163, 74, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn-success:hover {
            box-shadow: 
                0 8px 25px rgba(22, 163, 74, 0.3),
                0 0 20px rgba(34, 197, 94, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(34, 197, 94, 0.5);
        }

        .btn-warning {
            background: linear-gradient(135deg, #92400e 0%, #f59e0b 100%);
            border-color: rgba(245, 158, 11, 0.3);
            box-shadow: 
                0 4px 15px rgba(245, 158, 11, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn-warning:hover {
            box-shadow: 
                0 8px 25px rgba(245, 158, 11, 0.3),
                0 0 20px rgba(245, 158, 11, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(245, 158, 11, 0.5);
        }

        .btn-info {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 
                0 4px 15px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn-info:hover {
            box-shadow: 
                0 8px 25px rgba(59, 130, 246, 0.3),
                0 0 20px rgba(59, 130, 246, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
        }

        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 25px;
        }

        .host-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 18px;
            margin: 25px 0;
        }

        .host-item {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.8) 100%);
            border-radius: 14px;
            padding: 20px;
            border: 1px solid rgba(100, 179, 244, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            backdrop-filter: blur(10px);
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .host-item:hover {
            transform: translateY(-2px);
            border-color: rgba(100, 179, 244, 0.3);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(100, 179, 244, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .host-item.testing {
            border-color: rgba(245, 158, 11, 0.5);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(92, 400, 14, 0.1) 100%);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2);
        }

        .host-item.online {
            border-color: rgba(34, 197, 94, 0.5);
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(20, 83, 45, 0.1) 100%);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        .host-item.offline {
            border-color: rgba(239, 68, 68, 0.5);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(124, 45, 18, 0.1) 100%);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        .host-item.warning {
            border-color: rgba(245, 158, 11, 0.5);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(146, 64, 14, 0.1) 100%);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2);
        }

        .host-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .host-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #64b3f4;
        }

        .host-type {
            font-size: 0.8em;
            padding: 4px 10px;
            border-radius: 12px;
        }

        .host-type.custom {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .host-type.default {
            background: rgba(100, 179, 244, 0.2);
            color: #64b3f4;
            border: 1px solid rgba(100, 179, 244, 0.3);
        }

        /* å¿«é€Ÿå‹•ä½œå¡ç‰‡æ¨£å¼ */
        .quick-action-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.6) 100%);
            border-radius: 14px;
            padding: 20px;
            border: 1px solid rgba(100, 179, 244, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .quick-action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(100, 179, 244, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .quick-action-card:hover::before {
            left: 100%;
        }

        .quick-action-card:hover {
            transform: translateY(-4px);
            border-color: rgba(100, 179, 244, 0.3);
            box-shadow: 
                0 12px 30px rgba(0, 0, 0, 0.3),
                0 0 25px rgba(100, 179, 244, 0.15);
        }

        .quick-action-card:active {
            transform: translateY(-2px);
            transition: all 0.1s ease;
        }

        .host-url {
            font-size: 0.9em;
            color: #a8b2d1;
            margin-bottom: 8px;
            word-break: break-all;
        }

        .host-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #64748b;
        }

        .status-dot.online {
            background: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        .status-dot.offline {
            background: #ef4444;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        .status-dot.warning {
            background: #f59e0b;
            box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);
        }

        .status-dot.testing {
            background: #f59e0b;
            animation: pulse 1.5s infinite;
        }

        .host-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.8em;
            margin-top: 12px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }

        .detail-label {
            color: #a8b2d1;
        }

        .detail-value {
            color: #e8eaed;
            font-weight: 600;
        }

        .host-remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(239, 68, 68, 0.9);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            display: none;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .host-remove-btn:hover {
            background: rgba(220, 38, 38, 1);
            transform: scale(1.1);
        }

        .host-item:hover .host-remove-btn {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .results-area {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(15, 23, 42, 0.6) 100%);
            border-radius: 14px;
            padding: 25px;
            margin: 25px 0;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid rgba(100, 179, 244, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .results-area::-webkit-scrollbar {
            width: 8px;
        }

        .results-area::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .results-area::-webkit-scrollbar-thumb {
            background: rgba(100, 179, 244, 0.3);
            border-radius: 4px;
        }

        .results-area::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 179, 244, 0.5);
        }

        .log-entry {
            margin-bottom: 6px;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .log-info { 
            background: rgba(59, 130, 246, 0.1); 
            border-left-color: #3b82f6;
        }
        .log-success { 
            background: rgba(34, 197, 94, 0.1); 
            border-left-color: #22c55e;
        }
        .log-error { 
            background: rgba(239, 68, 68, 0.1); 
            border-left-color: #ef4444;
        }
        .log-warning { 
            background: rgba(245, 158, 11, 0.1); 
            border-left-color: #f59e0b;
        }

        /* ä¸»æ©Ÿé…ç½®å€åŸŸ */
        .host-config-section {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-radius: 14px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }

        .host-input-group {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 12px;
            margin-bottom: 18px;
            align-items: center;
        }

        .host-input, .name-input, .type-select {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.8) 100%);
            border: 1px solid rgba(100, 179, 244, 0.2);
            border-radius: 10px;
            padding: 12px 16px;
            color: #e8eaed;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .type-select option {
            background: #1e293b;
            color: #e8eaed;
            padding: 8px 12px;
        }

        .type-select option:hover {
            background: #334155;
        }

        .type-select option:checked {
            background: #3b82f6;
            color: #ffffff;
        }

        .host-input:focus, .name-input:focus, .type-select:focus {
            outline: none;
            border-color: rgba(100, 179, 244, 0.5);
            box-shadow: 0 0 0 3px rgba(100, 179, 244, 0.1);
        }

        .host-input::placeholder, .name-input::placeholder {
            color: rgba(168, 178, 209, 0.5);
        }

        /* æ—¥èªŒæ§åˆ¶å€åŸŸ */
        .log-control-section {
            background: linear-gradient(135deg, rgba(146, 64, 14, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
            border-radius: 14px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(245, 158, 11, 0.2);
            backdrop-filter: blur(10px);
        }

        .log-filter-group {
            display: flex;
            gap: 12px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }

        .log-filter-btn {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.8) 100%);
            border: 1px solid rgba(100, 179, 244, 0.2);
            border-radius: 25px;
            padding: 8px 18px;
            color: #e8eaed;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .log-filter-btn.active {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border-color: #f59e0b;
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.3);
        }

        .log-filter-btn:hover {
            background: linear-gradient(135deg, rgba(30, 41, 59, 1) 0%, rgba(15, 23, 42, 1) 100%);
            border-color: rgba(100, 179, 244, 0.4);
            transform: translateY(-1px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.6) 100%);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(100, 179, 244, 0.1);
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: 700;
            color: #64b3f4;
            display: block;
        }

        .stat-label {
            font-size: 0.8em;
            color: #a8b2d1;
            margin-top: 4px;
        }

        .uptime-bar {
            height: 4px;
            background: rgba(100, 179, 244, 0.2);
            border-radius: 2px;
            margin: 8px 0;
            overflow: hidden;
        }

        .uptime-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #22c55e);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .diagnostic-grid {
                grid-template-columns: 1fr;
            }
            .host-grid {
                grid-template-columns: 1fr;
            }
            .btn-grid {
                grid-template-columns: 1fr;
            }
            .host-input-group {
                grid-template-columns: 1fr;
            }
            .container {
                padding: 20px;
                margin: 10px;
            }
            .header h1 {
                font-size: 2.2em;
            }
        }

        /* è¼‰å…¥å‹•ç•« */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .container {
            animation: fadeInUp 0.8s ease-out;
        }

        /* è„ˆè¡å‹•ç•« */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }

        .testing .status-dot {
            animation: pulse 1.5s infinite;
        }

        /* è‡ªå‹•é‡æ–°æ•´ç†æŒ‡ç¤ºå™¨ */
        .auto-refresh-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9) 0%, rgba(15, 23, 42, 0.9) 100%);
            border-radius: 25px;
            padding: 8px 16px;
            font-size: 12px;
            color: #a8b2d1;
            border: 1px solid rgba(100, 179, 244, 0.2);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .auto-refresh-indicator.active {
            color: #22c55e;
            border-color: rgba(34, 197, 94, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><span style="filter: none; -webkit-text-fill-color: #64b3f4;">ğŸŒ</span> ä¸»æ©Ÿç›£æ§å·¥å…·</h1>
            <p>å³æ™‚ç›£æ§ä¸»æ©Ÿç‹€æ…‹ã€å›æ‡‰æ™‚é–“èˆ‡å¯ç”¨æ€§ | æ”¯æ´è‡ªè¨‚ä¸»æ©Ÿèˆ‡å¤–éƒ¨æœå‹™ç›£æ§</p>
        </div>

        <!-- è‡ªå‹•ç›£æ§æŒ‡ç¤ºå™¨ -->
        <div class="auto-refresh-indicator" id="autoRefreshIndicator">
            ğŸ”„ è‡ªå‹•ç›£æ§: é—œé–‰
        </div>

        <!-- çµ±è¨ˆè³‡è¨Š -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-number" id="totalHosts">0</span>
                <div class="stat-label">ç¸½ä¸»æ©Ÿæ•¸</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="onlineHosts">0</span>
                <div class="stat-label">ç·šä¸Šä¸»æ©Ÿ</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="offlineHosts">0</span>
                <div class="stat-label">é›¢ç·šä¸»æ©Ÿ</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="avgResponseTime">0</span>
                <div class="stat-label">å¹³å‡éŸ¿æ‡‰(ms)</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="totalUptime">0%</span>
                <div class="stat-label">ç¸½é«”å¯ç”¨æ€§</div>
            </div>
        </div>

        <div class="diagnostic-grid">
            <div class="panel">
                <div class="panel-title">ğŸ–¥ï¸ ä¸»æ©Ÿç›£æ§èˆ‡é…ç½®</div>
                
                <!-- ä¸»æ©Ÿé…ç½®å€åŸŸ -->
                <div class="host-config-section">
                    <h4 style="margin-bottom: 15px; color: #64b3f4;">â• æ–°å¢ç›£æ§ä¸»æ©Ÿ</h4>
                    <div class="host-input-group">
                        <input type="text" class="host-input" id="customHost" placeholder="ä¸»æ©Ÿåœ°å€ (ä¾‹å¦‚: https://google.com æˆ– 192.168.1.1:8080)">
                        <input type="text" class="name-input" id="customName" placeholder="ä¸»æ©Ÿåç¨±">
                        <select class="type-select" id="hostType">
                            <option value="website">ç¶²ç«™</option>
                            <option value="api">API æœå‹™</option>
                            <option value="server">ä¼ºæœå™¨</option>
                            <option value="database">è³‡æ–™åº«</option>
                            <option value="service">å…¶ä»–æœå‹™</option>
                        </select>
                        <button class="btn btn-info" onclick="addCustomHost()" style="width: auto; margin: 0;">æ–°å¢</button>
                    </div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 10px;">
                        ğŸ’¡ æ”¯æ´ HTTP/HTTPS ç¶²ç«™ã€IP ä½å€ã€é€£æ¥åŸ æª¢æ¸¬ç­‰ã€‚ä¾‹å¦‚ï¼šgoogle.com, 192.168.1.1:3000, https://api.github.com
                    </div>
                </div>

                <div class="btn-grid">
                    <button class="btn" onclick="monitorAllHosts()">ğŸ” æª¢æ¸¬æ‰€æœ‰ä¸»æ©Ÿ</button>
                    <button class="btn btn-warning" onclick="addCommonServices()">ğŸ“Š æ–°å¢å¸¸è¦‹æœå‹™</button>
                    <button class="btn btn-success" onclick="startAutoRefresh()">ğŸ”„ è‡ªå‹•é‡æ–°æ•´ç†</button>
                    <button class="btn btn-danger" onclick="stopAutoRefresh()">â¹ï¸ åœæ­¢è‡ªå‹•é‡æ–°æ•´ç†</button>
                </div>

                <!-- ä¸»æ©Ÿæ§åˆ¶å€åŸŸ -->
                <div style="margin: 15px 0; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn" onclick="toggleHostGrid()" style="flex: 1;">
                        <span id="hostGridToggleText">ğŸ”½ éš±è—ä¸»æ©Ÿç¶²æ ¼</span>
                    </button>
                    <button class="btn" onclick="resetToDefaultHosts()" style="flex: 1;">
                        ğŸ”„ é‡ç½®ç‚ºé è¨­ä¸»æ©Ÿ
                    </button>
                    <button class="btn btn-info" onclick="exportHostConfig()" style="flex: 1;">
                        ğŸ“¤ åŒ¯å‡ºé…ç½®
                    </button>
                    <button class="btn btn-info" onclick="importHostConfig()" style="flex: 1;">
                        ğŸ“¥ åŒ¯å…¥é…ç½®
                    </button>
                </div>

                <div class="host-grid panel-content" id="hostGrid">
                    <!-- ä¸»æ©Ÿç›£æ§çµæœå°‡åœ¨é€™è£¡é¡¯ç¤º -->
                </div>
            </div>

            <div class="panel">
                <div class="panel-title">ğŸ“Š ç›£æ§åˆ†æèˆ‡å ±å‘Š</div>
                
                <!-- ç³»çµ±åˆ†ææŒ‰éˆ•å€ -->
                <div class="btn-grid">
                    <button class="btn btn-success" onclick="generateDetailedReport()">ğŸ“‹ è©³ç´°ç›£æ§å ±å‘Š</button>
                    <button class="btn" onclick="performLatencyTest()">âš¡ å»¶é²æ¸¬è©¦</button>
                    <button class="btn btn-warning" onclick="checkSSLCertificates()">ğŸ”’ SSL æ†‘è­‰æª¢æŸ¥</button>
                    <button class="btn btn-info" onclick="tracerouteAnalysis()">ğŸ›£ï¸ è·¯ç”±è¿½è¹¤åˆ†æ</button>
                </div>

                <!-- ç›£æ§æ­·å²çµ±è¨ˆ -->
                <div id="monitoringStats" style="background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(15, 23, 42, 0.4) 100%); border-radius: 14px; padding: 20px; margin: 20px 0; border: 1px solid rgba(100, 179, 244, 0.1);">
                    <div style="text-align: center; opacity: 0.7;">é»æ“Šä¸Šæ–¹æŒ‰éˆ•é–‹å§‹åˆ†æ...</div>
                </div>

                <!-- è‡ªå‹•ç›£æ§è¨­å®š -->
                <div style="border-top: 1px solid rgba(100, 179, 244, 0.2); margin: 30px 0; padding-top: 25px;">
                    <h4 style="margin-bottom: 15px; color: #64b3f4;">â° è‡ªå‹•ç›£æ§è¨­å®š</h4>
                    <div style="background: linear-gradient(135deg, rgba(30, 58, 138, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%); border-radius: 14px; padding: 20px; border: 1px solid rgba(59, 130, 246, 0.2); backdrop-filter: blur(10px);">
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; margin-bottom: 15px;">
                            <label style="color: #e8eaed; font-weight: 600;">æª¢æ¸¬é–“éš” (ç§’):</label>
                            <input type="number" id="autoMonitorInterval" value="30" min="5" max="3600" 
                                   style="background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.8) 100%); border: 1px solid rgba(100, 179, 244, 0.2); border-radius: 8px; padding: 8px 12px; color: #e8eaed; font-size: 14px; width: 80px; text-align: center;">
                            <button class="btn btn-success" onclick="startAutoMonitoring()" style="width: auto; margin: 0;">ğŸš€ é–‹å§‹è‡ªå‹•ç›£æ§</button>
                            <button class="btn btn-danger" onclick="stopAutoMonitoring()" style="width: auto; margin: 0;">â¹ï¸ åœæ­¢ç›£æ§</button>
                        </div>
                        <div style="font-size: 12px; opacity: 0.8;">
                            ğŸ’¡ è¨­å®šè‡ªå‹•ç›£æ§é–“éš”æ™‚é–“ï¼Œç³»çµ±æœƒå®šæœŸæª¢æ¸¬æ‰€æœ‰ä¸»æ©Ÿç‹€æ…‹ã€‚å»ºè­°é–“éš” 30-300 ç§’ã€‚
                        </div>
                        <div id="autoMonitorStatus" style="margin-top: 10px; font-size: 13px; color: #a8b2d1;">
                            â¸ï¸ è‡ªå‹•ç›£æ§ï¼šå·²åœæ­¢
                        </div>
                    </div>
                </div>

                <!-- æ—¥èªŒæ§åˆ¶å€åŸŸ -->
                <div class="log-control-section">
                    <h4 style="margin-bottom: 15px; color: #f59e0b;">ğŸ“‹ æ—¥èªŒç®¡ç†</h4>
                    
                    <!-- æ—¥èªŒéæ¿¾æŒ‰éˆ• -->
                    <div class="log-filter-group">
                        <button class="log-filter-btn active" data-filter="all" onclick="filterLogs('all')">å…¨éƒ¨</button>
                        <button class="log-filter-btn" data-filter="info" onclick="filterLogs('info')">ä¿¡æ¯</button>
                        <button class="log-filter-btn" data-filter="success" onclick="filterLogs('success')">æˆåŠŸ</button>
                        <button class="log-filter-btn" data-filter="warning" onclick="filterLogs('warning')">è­¦å‘Š</button>
                        <button class="log-filter-btn" data-filter="error" onclick="filterLogs('error')">éŒ¯èª¤</button>
                    </div>

                    <!-- æ—¥èªŒæ“ä½œæŒ‰éˆ• -->
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-info" onclick="exportLogs('txt')" style="width: auto;">ğŸ“„ åŒ¯å‡º TXT</button>
                        <button class="btn btn-info" onclick="exportLogs('json')" style="width: auto;">ğŸ“Š åŒ¯å‡º JSON</button>
                        <button class="btn btn-info" onclick="exportLogs('csv')" style="width: auto;">ğŸ“ˆ åŒ¯å‡º CSV</button>
                        <button class="btn btn-warning" onclick="clearLogs()" style="width: auto;">ğŸ—‘ï¸ æ¸…ç©ºæ—¥èªŒ</button>
                        <button class="btn" onclick="toggleScanResults()" style="width: auto;">
                            <span id="scanResultsToggleText">ğŸ”½ éš±è—æ—¥èªŒ</span>
                        </button>
                    </div>
                </div>

                <div class="results-area panel-content" id="scanResults">
                    <div class="log-entry log-info">[ç³»çµ±] ä¸»æ©Ÿç›£æ§å·¥å…·å·²æº–å‚™å°±ç·’...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç›£æ§ä¸»æ©Ÿé…ç½®
        let hostsToMonitor = [
            { url: 'https://google.com', name: 'Google', type: 'website', critical: true },
            { url: 'https://github.com', name: 'GitHub', type: 'website', critical: false },
            { url: 'https://stackoverflow.com', name: 'Stack Overflow', type: 'website', critical: false },
            { url: 'https://api.github.com', name: 'GitHub API', type: 'api', critical: false },
            { url: 'https://httpbin.org/status/200', name: 'HTTPBin æ¸¬è©¦', type: 'api', critical: false },
            { url: 'https://cloudflare.com', name: 'Cloudflare', type: 'service', critical: false }
        ];

        const defaultHosts = [...hostsToMonitor]; // ä¿å­˜é è¨­ä¸»æ©Ÿé…ç½®
        let monitorResults = [];
        let logEntries = [];
        let currentLogFilter = 'all';
        let autoRefreshInterval = null;
        let autoMonitorInterval = null;
        let monitoringHistory = [];

        // æ·»åŠ è‡ªè¨‚ä¸»æ©Ÿ
        function addCustomHost() {
            const hostInput = document.getElementById('customHost');
            const nameInput = document.getElementById('customName');
            const typeSelect = document.getElementById('hostType');
            
            let hostUrl = hostInput.value.trim();
            const hostName = nameInput.value.trim();
            const hostType = typeSelect.value;
            
            if (!hostUrl) {
                addLog('è«‹è¼¸å…¥ä¸»æ©Ÿåœ°å€', 'error');
                return;
            }
            
            // è‡ªå‹•æ·»åŠ å”å®š
            if (!hostUrl.startsWith('http://') && !hostUrl.startsWith('https://')) {
                // å¦‚æœåŒ…å«é€£æ¥åŸ æˆ–æ˜¯ IPï¼Œé è¨­ä½¿ç”¨ http
                if (hostUrl.includes(':') || /^\d+\.\d+\.\d+\.\d+/.test(hostUrl)) {
                    hostUrl = 'http://' + hostUrl;
                } else {
                    hostUrl = 'https://' + hostUrl;
                }
            }
            
            const finalName = hostName || new URL(hostUrl).hostname;
            
            // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (hostsToMonitor.find(h => h.url === hostUrl)) {
                addLog(`ä¸»æ©Ÿ ${hostUrl} å·²åœ¨ç›£æ§åˆ—è¡¨ä¸­`, 'warning');
                return;
            }
            
            // æ–°å¢åˆ°åˆ—è¡¨
            hostsToMonitor.push({
                url: hostUrl,
                name: finalName,
                type: hostType,
                critical: false,
                custom: true
            });
            
            // æ¸…ç©ºè¼¸å…¥æ¡†
            hostInput.value = '';
            nameInput.value = '';
            
            // é‡æ–°åˆå§‹åŒ–ç¶²æ ¼
            initializeHostGrid();
            updateStats();
            addLog(`âœ… å·²æ–°å¢ç›£æ§ä¸»æ©Ÿ: ${finalName} (${hostUrl})`, 'success');
        }

        // æ”¹é€²ç§»é™¤ä¸»æ©ŸåŠŸèƒ½
        function removeHost(url) {
            const index = hostsToMonitor.findIndex(h => h.url === url);
            if (index !== -1) {
                const hostToRemove = hostsToMonitor[index];
                
                // ç¢ºèªåˆªé™¤ï¼ˆç‰¹åˆ¥æ˜¯é è¨­ä¸»æ©Ÿï¼‰
                const confirmMessage = hostToRemove.custom 
                    ? `ç¢ºå®šè¦åˆªé™¤è‡ªè¨‚ä¸»æ©Ÿ "${hostToRemove.name}" å—ï¼Ÿ`
                    : `ç¢ºå®šè¦åˆªé™¤é è¨­ä¸»æ©Ÿ "${hostToRemove.name}" å—ï¼Ÿ\nï¼ˆå¯ä»¥é€éé‡ç½®åŠŸèƒ½æ¢å¾©ï¼‰`;
                
                if (confirm(confirmMessage)) {
                    const removedHost = hostsToMonitor.splice(index, 1)[0];
                    
                    // åŒæ™‚æ¸…ç†ç›¸é—œæ•¸æ“š
                    if (monitoringHistory[url]) {
                        delete monitoringHistory[url];
                    }
                    monitorResults = monitorResults.filter(r => r.url !== url);
                    
                    initializeHostGrid();
                    updateStats();
                    
                    const hostTypeText = removedHost.custom ? 'è‡ªè¨‚ä¸»æ©Ÿ' : 'é è¨­ä¸»æ©Ÿ';
                    addLog(`âŒ å·²ç§»é™¤${hostTypeText}: ${removedHost.name}`, 'warning');
                    addLog(`ğŸ“Š ç›®å‰å…±ç›£æ§ ${hostsToMonitor.length} å€‹ä¸»æ©Ÿ`, 'info');
                }
            }
        }

        // é‡ç½®ç‚ºé è¨­ä¸»æ©Ÿ
        function resetToDefaultHosts() {
            hostsToMonitor = [...defaultHosts];
            initializeHostGrid();
            updateStats();
            addLog('ğŸ”„ å·²é‡ç½®ç‚ºé è¨­ä¸»æ©Ÿé…ç½®', 'info');
        }

        // åˆå§‹åŒ–ä¸»æ©Ÿç¶²æ ¼
        function initializeHostGrid() {
            const grid = document.getElementById('hostGrid');
            grid.innerHTML = '';
            
            hostsToMonitor.forEach(host => {
                const hostDiv = document.createElement('div');
                hostDiv.className = 'host-item';
                hostDiv.id = `host-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}`;
                
                const removeBtn = `<button class="host-remove-btn" onclick="removeHost('${host.url.replace(/'/g, "\\'")}')">Ã—</button>`;
                
                hostDiv.innerHTML = `
                    ${removeBtn}
                    <div class="host-header">
                        <div class="host-name">${host.name}</div>
                        <div class="host-type ${host.custom ? 'custom' : 'default'}">${getTypeDisplayName(host.type)}</div>
                    </div>
                    <div class="host-url">${host.url}</div>
                    <div class="host-status">
                        <div class="status-dot" id="status-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}"></div>
                        <span id="status-text-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}">æœªæ¸¬è©¦</span>
                    </div>
                    <div class="uptime-bar">
                        <div class="uptime-fill" id="uptime-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}" style="width: 0%"></div>
                    </div>
                    <div class="host-details">
                        <div class="detail-item">
                            <span class="detail-label">éŸ¿æ‡‰æ™‚é–“</span>
                            <span class="detail-value" id="response-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">ç‹€æ…‹ç¢¼</span>
                            <span class="detail-value" id="status-code-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">æœ€å¾Œæª¢æŸ¥</span>
                            <span class="detail-value" id="last-check-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">å¯ç”¨æ€§</span>
                            <span class="detail-value" id="availability-${btoa(host.url).replace(/[^a-zA-Z0-9]/g, '')}">-</span>
                        </div>
                    </div>
                `;
                grid.appendChild(hostDiv);
            });
        }

        // ç²å–é¡å‹é¡¯ç¤ºåç¨±
        function getTypeDisplayName(type) {
            const typeMap = {
                'website': 'ç¶²ç«™',
                'api': 'API',
                'server': 'ä¼ºæœå™¨',
                'database': 'è³‡æ–™åº«',
                'service': 'æœå‹™'
            };
            return typeMap[type] || type;
        }

        // æ›´æ–°ä¸»æ©Ÿç‹€æ…‹
        function updateHostStatus(url, status, data = {}) {
            const hostId = btoa(url).replace(/[^a-zA-Z0-9]/g, '');
            const hostElement = document.getElementById(`host-${hostId}`);
            const statusDot = document.getElementById(`status-${hostId}`);
            const statusText = document.getElementById(`status-text-${hostId}`);
            const responseTime = document.getElementById(`response-${hostId}`);
            const statusCode = document.getElementById(`status-code-${hostId}`);
            const lastCheck = document.getElementById(`last-check-${hostId}`);
            const availability = document.getElementById(`availability-${hostId}`);
            const uptimeBar = document.getElementById(`uptime-${hostId}`);
            
            if (hostElement && statusDot && statusText) {
                hostElement.className = `host-item ${status}`;
                statusDot.className = `status-dot ${status}`;
                
                const now = new Date().toLocaleTimeString();
                lastCheck.textContent = now;
                
                switch (status) {
                    case 'testing':
                        statusText.textContent = 'æª¢æ¸¬ä¸­...';
                        responseTime.textContent = '-';
                        statusCode.textContent = '-';
                        break;
                    case 'online':
                        statusText.textContent = 'ç·šä¸Š';
                        responseTime.textContent = data.responseTime ? `${data.responseTime}ms` : '-';
                        statusCode.textContent = data.statusCode || '-';
                        break;
                    case 'offline':
                        statusText.textContent = 'é›¢ç·š';
                        responseTime.textContent = data.responseTime ? `${data.responseTime}ms` : 'è¶…æ™‚';
                        statusCode.textContent = data.statusCode || 'ç„¡å›æ‡‰';
                        break;
                    case 'warning':
                        statusText.textContent = 'ç•°å¸¸';
                        responseTime.textContent = data.responseTime ? `${data.responseTime}ms` : '-';
                        statusCode.textContent = data.statusCode || '-';
                        break;
                }
                
                // æ›´æ–°å¯ç”¨æ€§çµ±è¨ˆ
                updateHostAvailability(url, status, uptimeBar, availability);
            }
        }

        // æ›´æ–°ä¸»æ©Ÿå¯ç”¨æ€§çµ±è¨ˆ
        function updateHostAvailability(url, status, uptimeBar, availability) {
            if (!monitoringHistory[url]) {
                monitoringHistory[url] = [];
            }
            
            monitoringHistory[url].push({
                timestamp: Date.now(),
                status: status,
                isOnline: status === 'online'
            });
            
            // ä¿æŒæœ€è¿‘100æ¬¡è¨˜éŒ„
            if (monitoringHistory[url].length > 100) {
                monitoringHistory[url] = monitoringHistory[url].slice(-100);
            }
            
            // è¨ˆç®—å¯ç”¨æ€§ç™¾åˆ†æ¯”
            const history = monitoringHistory[url];
            const onlineCount = history.filter(h => h.isOnline).length;
            const availabilityPercent = history.length > 0 ? (onlineCount / history.length * 100).toFixed(1) : 0;
            
            availability.textContent = `${availabilityPercent}%`;
            uptimeBar.style.width = `${availabilityPercent}%`;
        }

        // æ¸¬è©¦å–®å€‹ä¸»æ©Ÿ
        async function testHost(hostInfo) {
            const url = hostInfo.url;
            updateHostStatus(url, 'testing');
            addLog(`æ­£åœ¨æª¢æ¸¬ä¸»æ©Ÿ ${hostInfo.name} (${url})`, 'info');

            const startTime = performance.now();
            
            try {
                // æ ¹æ“šä¸åŒé¡å‹ä½¿ç”¨ä¸åŒçš„æ¸¬è©¦æ–¹æ³•
                let response;
                
                if (hostInfo.type === 'api') {
                    // API æ¸¬è©¦ï¼šä½¿ç”¨ HEAD æˆ– GET è«‹æ±‚
                    response = await fetch(url, {
                        method: 'GET',
                        signal: AbortSignal.timeout(10000),
                        mode: 'cors'
                    });
                } else {
                    // ç¶²ç«™æ¸¬è©¦ï¼šä½¿ç”¨ HEAD è«‹æ±‚ï¼ˆæ›´è¼•é‡ï¼‰
                    response = await fetch(url, {
                        method: 'HEAD',
                        signal: AbortSignal.timeout(10000),
                        mode: 'no-cors'
                    });
                }

                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                let status, statusText;
                
                if (response.ok || response.type === 'opaque') {
                    status = 'online';
                    statusText = 'ç·šä¸Š';
                    addLog(`âœ… ${hostInfo.name} å›æ‡‰æ­£å¸¸ (${responseTime}ms)`, 'success');
                } else if (response.status >= 400 && response.status < 500) {
                    status = 'warning';
                    statusText = `å®¢æˆ¶ç«¯éŒ¯èª¤ (${response.status})`;
                    addLog(`âš ï¸ ${hostInfo.name} å®¢æˆ¶ç«¯éŒ¯èª¤ HTTP ${response.status}`, 'warning');
                } else if (response.status >= 500) {
                    status = 'warning';
                    statusText = `ä¼ºæœå™¨éŒ¯èª¤ (${response.status})`;
                    addLog(`âš ï¸ ${hostInfo.name} ä¼ºæœå™¨éŒ¯èª¤ HTTP ${response.status}`, 'warning');
                } else {
                    status = 'warning';
                    statusText = `æœªçŸ¥ç‹€æ…‹ (${response.status})`;
                    addLog(`âš ï¸ ${hostInfo.name} æœªçŸ¥ç‹€æ…‹ HTTP ${response.status}`, 'warning');
                }

                updateHostStatus(url, status, {
                    responseTime,
                    statusCode: response.status || '200',
                    statusText
                });

                monitorResults.push({
                    url,
                    name: hostInfo.name,
                    type: hostInfo.type,
                    status,
                    responseTime,
                    statusCode: response.status,
                    timestamp: new Date().toISOString()
                });

                return { url, status, responseTime, statusCode: response.status };

            } catch (error) {
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                updateHostStatus(url, 'offline', {
                    responseTime,
                    statusCode: 'é€£æ¥å¤±æ•—',
                    error: error.message
                });

                addLog(`âŒ ${hostInfo.name} é€£æ¥å¤±æ•—: ${error.message}`, 'error');
                
                monitorResults.push({
                    url,
                    name: hostInfo.name,
                    type: hostInfo.type,
                    status: 'offline',
                    responseTime,
                    error: error.message,
                    timestamp: new Date().toISOString()
                });

                return { url, status: 'offline', error: error.message };
            }
        }

        // ç›£æ§æ‰€æœ‰ä¸»æ©Ÿ
        async function monitorAllHosts() {
            addLog('é–‹å§‹ç›£æ§æ‰€æœ‰ä¸»æ©Ÿ...', 'info');
            addLog(`ğŸ¯ å°‡ç›£æ§ ${hostsToMonitor.length} å€‹ä¸»æ©Ÿ`, 'info');
            monitorResults = [];
            
            // ä¸¦è¡Œæ¸¬è©¦æ‰€æœ‰ä¸»æ©Ÿ
            const promises = hostsToMonitor.map(host => testHost(host));

            try {
                await Promise.all(promises);
                addLog('ä¸»æ©Ÿç›£æ§å®Œæˆ', 'success');
                updateStats();
                analyzeMonitorResults();
            } catch (error) {
                addLog(`ç›£æ§éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        // åˆ†æç›£æ§çµæœ
        function analyzeMonitorResults() {
            const onlineHosts = monitorResults.filter(r => r.status === 'online');
            const offlineHosts = monitorResults.filter(r => r.status === 'offline');
            const warningHosts = monitorResults.filter(r => r.status === 'warning');
            
            addLog(`ç›£æ§çµæœ: ${onlineHosts.length} å€‹ç·šä¸Š, ${offlineHosts.length} å€‹é›¢ç·š, ${warningHosts.length} å€‹ç•°å¸¸`, 'info');

            // è­˜åˆ¥é—œéµæœå‹™å•é¡Œ
            const criticalOffline = offlineHosts.filter(h => 
                hostsToMonitor.find(host => host.url === h.url && host.critical)
            );

            if (criticalOffline.length > 0) {
                addLog(`ğŸš¨ é—œéµæœå‹™é›¢ç·š: ${criticalOffline.map(h => h.name).join(', ')}`, 'error');
            }

            // è­˜åˆ¥é«˜å»¶é²æœå‹™
            const highLatency = onlineHosts.filter(h => h.responseTime > 3000);
            if (highLatency.length > 0) {
                addLog(`âš ï¸ é«˜å»¶é²æœå‹™: ${highLatency.map(h => `${h.name}(${h.responseTime}ms)`).join(', ')}`, 'warning');
            }
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Š
        function updateStats() {
            const totalHosts = hostsToMonitor.length;
            const onlineCount = monitorResults.filter(r => r.status === 'online').length;
            const offlineCount = monitorResults.filter(r => r.status === 'offline').length;
            
            // è¨ˆç®—å¹³å‡éŸ¿æ‡‰æ™‚é–“
            const onlineResults = monitorResults.filter(r => r.status === 'online' && r.responseTime);
            const avgResponseTime = onlineResults.length > 0 
                ? Math.round(onlineResults.reduce((sum, r) => sum + r.responseTime, 0) / onlineResults.length)
                : 0;

            // è¨ˆç®—ç¸½é«”å¯ç”¨æ€§
            const totalUptime = totalHosts > 0 ? Math.round((onlineCount / totalHosts) * 100) : 0;

            document.getElementById('totalHosts').textContent = totalHosts;
            document.getElementById('onlineHosts').textContent = onlineCount;
            document.getElementById('offlineHosts').textContent = offlineCount;
            document.getElementById('avgResponseTime').textContent = avgResponseTime;
            document.getElementById('totalUptime').textContent = `${totalUptime}%`;
        }

        // æ·»åŠ å¸¸è¦‹æœå‹™
        function addCommonServices() {
            const commonServices = [
                { url: 'https://www.facebook.com', name: 'Facebook', type: 'website' },
                { url: 'https://twitter.com', name: 'Twitter/X', type: 'website' },
                { url: 'https://www.youtube.com', name: 'YouTube', type: 'website' },
                { url: 'https://api.openai.com', name: 'OpenAI API', type: 'api' },
                { url: 'https://httpstat.us/200', name: 'HTTP ç‹€æ…‹æ¸¬è©¦', type: 'api' },
                { url: 'https://jsonplaceholder.typicode.com', name: 'JSON Placeholder', type: 'api' },
                { url: 'https://www.cloudflare.com', name: 'Cloudflare CDN', type: 'service' },
                { url: 'https://8.8.8.8', name: 'Google DNS', type: 'server' }
            ];

            let addedCount = 0;
            commonServices.forEach(service => {
                if (!hostsToMonitor.find(h => h.url === service.url)) {
                    hostsToMonitor.push({
                        ...service,
                        critical: false,
                        custom: true
                    });
                    addedCount++;
                }
            });

            if (addedCount > 0) {
                initializeHostGrid();
                updateStats();
                addLog(`âœ… å·²æ–°å¢ ${addedCount} å€‹å¸¸è¦‹æœå‹™`, 'success');
            } else {
                addLog('æ‰€æœ‰å¸¸è¦‹æœå‹™éƒ½å·²åœ¨ç›£æ§åˆ—è¡¨ä¸­', 'info');
            }
        }

        // è‡ªå‹•ç›£æ§åŠŸèƒ½
        function startAutoMonitoring() {
            if (autoMonitorInterval) {
                clearInterval(autoMonitorInterval);
            }

            const intervalInput = document.getElementById('autoMonitorInterval');
            const statusDiv = document.getElementById('autoMonitorStatus');
            
            if (!intervalInput || !statusDiv) {
                addLog('âŒ æ‰¾ä¸åˆ°è‡ªå‹•ç›£æ§è¨­å®šå…ƒç´ ', 'error');
                return;
            }

            const interval = parseInt(intervalInput.value);
            if (isNaN(interval) || interval < 5) {
                addLog('âŒ ç„¡æ•ˆçš„é–“éš”æ™‚é–“ï¼ˆæœ€å°‘5ç§’ï¼‰', 'error');
                intervalInput.focus();
                return;
            }

            // ç«‹å³åŸ·è¡Œä¸€æ¬¡ç›£æ§
            monitorAllHosts();

            // è¨­å®šå®šæ™‚ç›£æ§
            autoMonitorInterval = setInterval(() => {
                addLog(`ğŸ”„ è‡ªå‹•ç›£æ§æª¢æ¸¬ (æ¯ ${interval} ç§’)`, 'info');
                monitorAllHosts();
            }, interval * 1000);

            // æ›´æ–°ç‹€æ…‹é¡¯ç¤º
            statusDiv.innerHTML = `ğŸŸ¢ è‡ªå‹•ç›£æ§ï¼šå·²å•Ÿå‹• (æ¯ ${interval} ç§’æª¢æ¸¬ä¸€æ¬¡)`;
            statusDiv.style.color = '#22c55e';

            // æ›´æ–°è‡ªå‹•é‡æ–°æ•´ç†æŒ‡ç¤ºå™¨
            const indicator = document.getElementById('autoRefreshIndicator');
            if (indicator) {
                indicator.textContent = `ğŸ”„ è‡ªå‹•ç›£æ§: æ¯ ${interval} ç§’`;
                indicator.classList.add('active');
            }

            addLog(`âœ… å·²å•Ÿç”¨è‡ªå‹•ç›£æ§ (æ¯ ${interval} ç§’æª¢æ¸¬æ‰€æœ‰ä¸»æ©Ÿ)`, 'success');
        }

        function stopAutoMonitoring() {
            const statusDiv = document.getElementById('autoMonitorStatus');
            
            if (autoMonitorInterval) {
                clearInterval(autoMonitorInterval);
                autoMonitorInterval = null;

                // æ›´æ–°ç‹€æ…‹é¡¯ç¤º
                if (statusDiv) {
                    statusDiv.innerHTML = 'â¸ï¸ è‡ªå‹•ç›£æ§ï¼šå·²åœæ­¢';
                    statusDiv.style.color = '#a8b2d1';
                }

                // æ›´æ–°è‡ªå‹•é‡æ–°æ•´ç†æŒ‡ç¤ºå™¨
                const indicator = document.getElementById('autoRefreshIndicator');
                if (indicator) {
                    indicator.textContent = 'ğŸ”„ è‡ªå‹•ç›£æ§: é—œé–‰';
                    indicator.classList.remove('active');
                }

                addLog('â¹ï¸ å·²åœæ­¢è‡ªå‹•ç›£æ§', 'warning');
            } else {
                addLog('âš ï¸ è‡ªå‹•ç›£æ§æœªå•Ÿå‹•', 'warning');
            }
        }

        // è¨˜éŒ„æ—¥èªŒ
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = {
                timestamp: timestamp,
                message: message,
                type: type,
                fullTimestamp: new Date().toISOString()
            };
            
            logEntries.push(logEntry);
            
            // åªé¡¯ç¤ºç¬¦åˆç•¶å‰éæ¿¾å™¨çš„æ—¥èªŒ
            if (currentLogFilter === 'all' || currentLogFilter === type) {
                displayLogEntry(logEntry);
            }
        }

        // é¡¯ç¤ºæ—¥èªŒæ¢ç›®
        function displayLogEntry(logEntry) {
            const results = document.getElementById('scanResults');
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry log-${logEntry.type}`;
            logDiv.textContent = `[${logEntry.timestamp}] ${logEntry.message}`;
            results.appendChild(logDiv);
            results.scrollTop = results.scrollHeight;
        }

        // éæ¿¾æ—¥èªŒ
        function filterLogs(filterType) {
            currentLogFilter = filterType;
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.log-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filterType}"]`).classList.add('active');
            
            // é‡æ–°é¡¯ç¤ºæ—¥èªŒ
            const results = document.getElementById('scanResults');
            results.innerHTML = '';
            
            logEntries.forEach(entry => {
                if (filterType === 'all' || filterType === entry.type) {
                    displayLogEntry(entry);
                }
            });
            
            addLog(`ğŸ” å·²éæ¿¾é¡¯ç¤º: ${filterType === 'all' ? 'å…¨éƒ¨' : filterType} é¡å‹æ—¥èªŒ`, 'info');
        }

        // æ¸…ç©ºæ—¥èªŒ
        function clearLogs() {
            if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥èªŒå—ï¼Ÿ')) {
                logEntries = [];
                document.getElementById('scanResults').innerHTML = '';
                addLog('ğŸ—‘ï¸ æ—¥èªŒå·²æ¸…ç©º', 'info');
            }
        }

        // åŒ¯å‡ºæ—¥èªŒ
        function exportLogs(format) {
            if (logEntries.length === 0) {
                addLog('æ²’æœ‰æ—¥èªŒå¯ä»¥åŒ¯å‡º', 'warning');
                return;
            }

            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            let content, filename, mimeType;

            switch (format) {
                case 'txt':
                    content = logEntries.map(entry => 
                        `[${entry.timestamp}] [${entry.type.toUpperCase()}] ${entry.message}`
                    ).join('\n');
                    filename = `ä¸»æ©Ÿç›£æ§æ—¥èªŒ-${timestamp}.txt`;
                    mimeType = 'text/plain';
                    break;

                case 'json':
                    content = JSON.stringify({
                        exportTime: new Date().toISOString(),
                        totalEntries: logEntries.length,
                        monitorResults: monitorResults,
                        logs: logEntries
                    }, null, 2);
                    filename = `ä¸»æ©Ÿç›£æ§æ—¥èªŒ-${timestamp}.json`;
                    mimeType = 'application/json';
                    break;

                case 'csv':
                    const csvHeader = 'Time,Type,Message,FullTimestamp\n';
                    const csvContent = logEntries.map(entry => 
                        `"${entry.timestamp}","${entry.type}","${entry.message.replace(/"/g, '""')}","${entry.fullTimestamp}"`
                    ).join('\n');
                    content = csvHeader + csvContent;
                    filename = `ä¸»æ©Ÿç›£æ§æ—¥èªŒ-${timestamp}.csv`;
                    mimeType = 'text/csv';
                    break;

                default:
                    addLog('ä¸æ”¯æ´çš„åŒ¯å‡ºæ ¼å¼', 'error');
                    return;
            }

            // å‰µå»ºä¸‹è¼‰é€£çµ
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);

            addLog(`ğŸ“¤ æ—¥èªŒå·²åŒ¯å‡ºç‚º ${format.toUpperCase()} æ ¼å¼ (${logEntries.length} æ¢è¨˜éŒ„)`, 'success');
        }

        // æ‘ºç–Šä¸»æ©Ÿç¶²æ ¼
        function toggleHostGrid() {
            const hostGrid = document.getElementById('hostGrid');
            const toggleText = document.getElementById('hostGridToggleText');
            
            if (hostGrid.classList.contains('collapsed')) {
                hostGrid.classList.remove('collapsed');
                toggleText.textContent = 'ğŸ”½ éš±è—ä¸»æ©Ÿç¶²æ ¼';
                addLog('å±•é–‹ä¸»æ©Ÿç¶²æ ¼', 'info');
            } else {
                hostGrid.classList.add('collapsed');
                toggleText.textContent = 'â–¶ï¸ é¡¯ç¤ºä¸»æ©Ÿç¶²æ ¼';
                addLog('éš±è—ä¸»æ©Ÿç¶²æ ¼', 'info');
            }
        }

        // æ‘ºç–Šæƒæçµæœ
        function toggleScanResults() {
            const scanResults = document.getElementById('scanResults');
            const toggleText = document.getElementById('scanResultsToggleText');
            
            if (scanResults.classList.contains('collapsed')) {
                scanResults.classList.remove('collapsed');
                toggleText.textContent = 'ğŸ”½ éš±è—æ—¥èªŒ';
                addLog('å±•é–‹è¨Šæ¯æ—¥èªŒ', 'info');
            } else {
                scanResults.classList.add('collapsed');
                toggleText.textContent = 'â–¶ï¸ é¡¯ç¤ºæ—¥èªŒ';
                addLog('éš±è—è¨Šæ¯æ—¥èªŒ', 'info');
            }
        }

        // åŒ¯å‡ºä¸»æ©Ÿé…ç½®
        function exportHostConfig() {
            const config = {
                exportTime: new Date().toISOString(),
                hosts: hostsToMonitor,
                customHostsCount: hostsToMonitor.filter(h => h.custom).length,
                monitoringHistory: monitoringHistory
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ä¸»æ©Ÿç›£æ§é…ç½®-${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            addLog('ğŸ“¤ ä¸»æ©Ÿé…ç½®å·²åŒ¯å‡º', 'success');
        }

        // åŒ¯å…¥ä¸»æ©Ÿé…ç½®
        function importHostConfig() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const config = JSON.parse(e.target.result);
                        if (config.hosts && Array.isArray(config.hosts)) {
                            hostsToMonitor = config.hosts;
                            if (config.monitoringHistory) {
                                monitoringHistory = config.monitoringHistory;
                            }
                            initializeHostGrid();
                            updateStats();
                            addLog(`ğŸ“¥ å·²åŒ¯å…¥ ${config.hosts.length} å€‹ä¸»æ©Ÿé…ç½®`, 'success');
                        } else {
                            addLog('âŒ ç„¡æ•ˆçš„é…ç½®æ–‡ä»¶æ ¼å¼', 'error');
                        }
                    } catch (error) {
                        addLog('âŒ é…ç½®æ–‡ä»¶è§£æå¤±æ•—', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // ç”Ÿæˆè©³ç´°ç›£æ§å ±å‘Š
        function generateDetailedReport() {
            const timestamp = new Date().toLocaleString();
            
            // çµ±è¨ˆä¿¡æ¯
            const stats = {
                totalHosts: hostsToMonitor.length,
                customHosts: hostsToMonitor.filter(h => h.custom).length,
                onlineHosts: monitorResults.filter(r => r.status === 'online').length,
                offlineHosts: monitorResults.filter(r => r.status === 'offline').length,
                warningHosts: monitorResults.filter(r => r.status === 'warning').length,
                totalLogs: logEntries.length,
                errorLogs: logEntries.filter(l => l.type === 'error').length,
                warningLogs: logEntries.filter(l => l.type === 'warning').length
            };

            // éŸ¿æ‡‰æ™‚é–“çµ±è¨ˆ
            const onlineResults = monitorResults.filter(r => r.status === 'online' && r.responseTime);
            const responseStats = {
                avgResponseTime: onlineResults.length > 0 ? Math.round(onlineResults.reduce((sum, r) => sum + r.responseTime, 0) / onlineResults.length) : 0,
                minResponseTime: onlineResults.length > 0 ? Math.min(...onlineResults.map(r => r.responseTime)) : 0,
                maxResponseTime: onlineResults.length > 0 ? Math.max(...onlineResults.map(r => r.responseTime)) : 0
            };
            
            const report = `# ä¸»æ©Ÿç›£æ§è©³ç´°å ±å‘Š
ç”Ÿæˆæ™‚é–“: ${timestamp}

## ğŸ“Š ç›£æ§çµ±è¨ˆæ‘˜è¦
- ç¸½ç›£æ§ä¸»æ©Ÿæ•¸: ${stats.totalHosts}
- è‡ªè¨‚ä¸»æ©Ÿæ•¸: ${stats.customHosts}
- ç·šä¸Šä¸»æ©Ÿ: ${stats.onlineHosts}
- é›¢ç·šä¸»æ©Ÿ: ${stats.offlineHosts}
- ç•°å¸¸ä¸»æ©Ÿ: ${stats.warningHosts}
- ç¸½é«”å¯ç”¨æ€§: ${stats.totalHosts > 0 ? ((stats.onlineHosts / stats.totalHosts) * 100).toFixed(1) : 0}%
- ç¸½æ—¥èªŒæ¢æ•¸: ${stats.totalLogs}
- éŒ¯èª¤æ—¥èªŒ: ${stats.errorLogs}
- è­¦å‘Šæ—¥èªŒ: ${stats.warningLogs}

## âš¡ éŸ¿æ‡‰æ™‚é–“åˆ†æ
- å¹³å‡éŸ¿æ‡‰æ™‚é–“: ${responseStats.avgResponseTime}ms
- æœ€å¿«éŸ¿æ‡‰æ™‚é–“: ${responseStats.minResponseTime}ms
- æœ€æ…¢éŸ¿æ‡‰æ™‚é–“: ${responseStats.maxResponseTime}ms

## ğŸ–¥ï¸ ä¸»æ©Ÿé…ç½®è©³ç´°
${hostsToMonitor.map(host => `
ä¸»æ©Ÿåç¨±: ${host.name}
åœ°å€: ${host.url}
é¡å‹: ${getTypeDisplayName(host.type)}
è‡ªè¨‚: ${host.custom ? 'æ˜¯' : 'å¦'}
é—œéµæœå‹™: ${host.critical ? 'æ˜¯' : 'å¦'}
`).join('\n')}

## ğŸ“‹ ç›£æ§çµæœè©³ç´°
${monitorResults.map(result => `
ä¸»æ©Ÿ: ${result.name} (${result.url})
ç‹€æ…‹: ${result.status}
éŸ¿æ‡‰æ™‚é–“: ${result.responseTime || '-'}ms
ç‹€æ…‹ç¢¼: ${result.statusCode || '-'}
æª¢æ¸¬æ™‚é–“: ${result.timestamp}
${result.error ? `éŒ¯èª¤: ${result.error}` : ''}
`).join('\n')}

## ğŸ” å¯ç”¨æ€§æ­·å²
${Object.entries(monitoringHistory).map(([url, history]) => {
    const host = hostsToMonitor.find(h => h.url === url);
    const onlineCount = history.filter(h => h.isOnline).length;
    const availabilityPercent = history.length > 0 ? (onlineCount / history.length * 100).toFixed(1) : 0;
    return `${host ? host.name : url}: ${availabilityPercent}% (${onlineCount}/${history.length} æ¬¡æª¢æ¸¬æˆåŠŸ)`;
}).join('\n')}

## ğŸ“ å®Œæ•´æ—¥èªŒè¨˜éŒ„
${logEntries.map(entry => `[${entry.timestamp}] [${entry.type.toUpperCase()}] ${entry.message}`).join('\n')}

## ğŸ’¡ å»ºè­°èˆ‡è­¦å‘Š
${stats.offlineHosts > 0 ? `âš ï¸ ç™¼ç¾ ${stats.offlineHosts} å€‹é›¢ç·šä¸»æ©Ÿï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥æˆ–æœå‹™ç‹€æ…‹` : 'âœ… æ‰€æœ‰ç›£æ§ä¸»æ©Ÿé‹è¡Œæ­£å¸¸'}
${responseStats.avgResponseTime > 3000 ? `âš ï¸ å¹³å‡éŸ¿æ‡‰æ™‚é–“è¼ƒé«˜ (${responseStats.avgResponseTime}ms)ï¼Œå»ºè­°æª¢æŸ¥ç¶²è·¯æˆ–ä¼ºæœå™¨æ€§èƒ½` : ''}
${stats.errorLogs > stats.totalLogs * 0.2 ? `âš ï¸ éŒ¯èª¤æ—¥èªŒæ¯”ä¾‹è¼ƒé«˜ (${((stats.errorLogs / stats.totalLogs) * 100).toFixed(1)}%)ï¼Œè«‹æ³¨æ„ç›£æ§ç•°å¸¸` : ''}

## ğŸ”— ç³»çµ±è³‡è¨Š
- å ±å‘Šç”Ÿæˆæ™‚é–“: ${timestamp}
- ç›£æ§å·¥å…·ç‰ˆæœ¬: v2.0
- ç€è¦½å™¨: ${navigator.userAgent}
- æ™‚å€: ${Intl.DateTimeFormat().resolvedOptions().timeZone}
            `;

            // å‰µå»ºä¸‹è¼‰é€£çµ
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ä¸»æ©Ÿç›£æ§è©³ç´°å ±å‘Š-${timestamp.replace(/[/:]/g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);

            addLog(`ğŸ“‹ è©³ç´°ç›£æ§å ±å‘Šå·²ç”Ÿæˆä¸¦ä¸‹è¼‰ (${stats.totalLogs} æ¢æ—¥èªŒ)`, 'success');
        }

        // å»¶é²æ¸¬è©¦
        async function performLatencyTest() {
            addLog('ğŸš€ é–‹å§‹å»¶é²æ¸¬è©¦...', 'info');
            
            const statsDiv = document.getElementById('monitoringStats');
            statsDiv.innerHTML = '<div style="text-align: center; opacity: 0.7;">æ­£åœ¨åŸ·è¡Œå»¶é²æ¸¬è©¦...</div>';
            
            const latencyResults = [];
            
            for (const host of hostsToMonitor) {
                addLog(`æ¸¬è©¦ ${host.name} å»¶é²...`, 'info');
                
                const attempts = 5;
                const pingTimes = [];
                
                for (let i = 0; i < attempts; i++) {
                    try {
                        const startTime = performance.now();
                        const response = await fetch(host.url, {
                            method: 'HEAD',
                            signal: AbortSignal.timeout(5000),
                            mode: 'no-cors'
                        });
                        const endTime = performance.now();
                        pingTimes.push(Math.round(endTime - startTime));
                    } catch (error) {
                        pingTimes.push(null);
                    }
                }
                
                const validPings = pingTimes.filter(t => t !== null);
                const avgLatency = validPings.length > 0 ? Math.round(validPings.reduce((a, b) => a + b, 0) / validPings.length) : null;
                const minLatency = validPings.length > 0 ? Math.min(...validPings) : null;
                const maxLatency = validPings.length > 0 ? Math.max(...validPings) : null;
                const packetLoss = ((attempts - validPings.length) / attempts * 100).toFixed(1);
                
                latencyResults.push({
                    name: host.name,
                    url: host.url,
                    avgLatency,
                    minLatency,
                    maxLatency,
                    packetLoss,
                    attempts,
                    successful: validPings.length
                });
                
                if (avgLatency) {
                    addLog(`${host.name}: å¹³å‡ ${avgLatency}ms, å°åŒ…éºå¤± ${packetLoss}%`, avgLatency > 3000 ? 'warning' : 'success');
                } else {
                    addLog(`${host.name}: ç„¡æ³•é€£æ¥`, 'error');
                }
            }
            
            // é¡¯ç¤ºå»¶é²æ¸¬è©¦çµæœ
            let html = `
                <div style="margin-bottom: 15px;">
                    <strong>âš¡ å»¶é²æ¸¬è©¦çµæœ (5æ¬¡æ¸¬è©¦å¹³å‡å€¼)</strong>
                </div>
            `;
            
            latencyResults.forEach(result => {
                const statusColor = result.avgLatency === null ? '#ef4444' : 
                                  result.avgLatency > 3000 ? '#f59e0b' : '#22c55e';
                
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; margin: 5px 0; background: rgba(30, 41, 59, 0.6); border-radius: 8px; border-left: 3px solid ${statusColor};">
                        <div>
                            <strong>${result.name}</strong><br>
                            <small style="opacity: 0.8;">${result.url}</small>
                        </div>
                        <div style="text-align: right;">
                            ${result.avgLatency !== null ? `
                                <div>å¹³å‡: <strong>${result.avgLatency}ms</strong></div>
                                <div style="font-size: 0.8em; opacity: 0.8;">ç¯„åœ: ${result.minLatency}-${result.maxLatency}ms</div>
                                <div style="font-size: 0.8em; opacity: 0.8;">å°åŒ…éºå¤±: ${result.packetLoss}%</div>
                            ` : `
                                <div style="color: #ef4444;"><strong>ç„¡æ³•é€£æ¥</strong></div>
                                <div style="font-size: 0.8em; opacity: 0.8;">0/${result.attempts} æˆåŠŸ</div>
                            `}
                        </div>
                    </div>
                `;
            });
            
            statsDiv.innerHTML = html;
            addLog('âš¡ å»¶é²æ¸¬è©¦å®Œæˆ', 'success');
        }

        // SSL æ†‘è­‰æª¢æŸ¥
        async function checkSSLCertificates() {
            addLog('ğŸ”’ é–‹å§‹ SSL æ†‘è­‰æª¢æŸ¥...', 'info');
            
            const statsDiv = document.getElementById('monitoringStats');
            statsDiv.innerHTML = '<div style="text-align: center; opacity: 0.7;">æ­£åœ¨æª¢æŸ¥ SSL æ†‘è­‰...</div>';
            
            const sslResults = [];
            const httpsHosts = hostsToMonitor.filter(host => host.url.startsWith('https://'));
            
            if (httpsHosts.length === 0) {
                addLog('âš ï¸ æ²’æœ‰ HTTPS ä¸»æ©Ÿéœ€è¦æª¢æŸ¥', 'warning');
                statsDiv.innerHTML = '<div style="text-align: center; opacity: 0.7;">æ²’æœ‰ HTTPS ä¸»æ©Ÿéœ€è¦æª¢æŸ¥ SSL æ†‘è­‰</div>';
                return;
            }
            
            for (const host of httpsHosts) {
                try {
                    addLog(`æª¢æŸ¥ ${host.name} SSL æ†‘è­‰...`, 'info');
                    
                    // æ³¨æ„ï¼šåœ¨ç€è¦½å™¨ç’°å¢ƒä¸­ï¼Œæˆ‘å€‘ç„¡æ³•ç›´æ¥ç²å– SSL æ†‘è­‰è©³ç´°ä¿¡æ¯
                    // é€™è£¡æ¨¡æ“¬ SSL æª¢æŸ¥é‚è¼¯
                    const response = await fetch(host.url, {
                        method: 'HEAD',
                        signal: AbortSignal.timeout(10000)
                    });
                    
                    const sslInfo = {
                        name: host.name,
                        url: host.url,
                        isSecure: host.url.startsWith('https://'),
                        responseOk: response.ok,
                        status: response.ok ? 'valid' : 'error',
                        message: response.ok ? 'SSL é€£æ¥æ­£å¸¸' : `HTTP ${response.status} éŒ¯èª¤`
                    };
                    
                    sslResults.push(sslInfo);
                    addLog(`${host.name}: ${sslInfo.message}`, response.ok ? 'success' : 'error');
                    
                } catch (error) {
                    const sslInfo = {
                        name: host.name,
                        url: host.url,
                        isSecure: false,
                        responseOk: false,
                        status: 'error',
                        message: `SSL é€£æ¥å¤±æ•—: ${error.message}`
                    };
                    
                    sslResults.push(sslInfo);
                    addLog(`${host.name}: ${sslInfo.message}`, 'error');
                }
            }
            
            // é¡¯ç¤º SSL æª¢æŸ¥çµæœ
            let html = `
                <div style="margin-bottom: 15px;">
                    <strong>ğŸ”’ SSL æ†‘è­‰æª¢æŸ¥çµæœ</strong>
                </div>
                <div style="margin-bottom: 10px; font-size: 0.9em; opacity: 0.8;">
                    æ³¨æ„ï¼šç€è¦½å™¨ç’°å¢ƒé™åˆ¶ï¼Œåƒ…èƒ½æª¢æŸ¥åŸºæœ¬ SSL é€£æ¥ç‹€æ…‹
                </div>
            `;
            
            sslResults.forEach(result => {
                const statusColor = result.status === 'valid' ? '#22c55e' : '#ef4444';
                const statusIcon = result.status === 'valid' ? 'âœ…' : 'âŒ';
                
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; margin: 5px 0; background: rgba(30, 41, 59, 0.6); border-radius: 8px; border-left: 3px solid ${statusColor};">
                        <div>
                            <strong>${result.name}</strong><br>
                            <small style="opacity: 0.8;">${result.url}</small>
                        </div>
                        <div style="text-align: right;">
                            <div>${statusIcon} <strong>${result.message}</strong></div>
                            <div style="font-size: 0.8em; opacity: 0.8;">
                                ${result.isSecure ? 'HTTPS å”å®š' : 'HTTP å”å®š'}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            statsDiv.innerHTML = html;
            addLog('ğŸ”’ SSL æ†‘è­‰æª¢æŸ¥å®Œæˆ', 'success');
        }

        // è·¯ç”±è¿½è¹¤åˆ†æï¼ˆæ¨¡æ“¬ï¼‰
        function tracerouteAnalysis() {
            addLog('ğŸ›£ï¸ é–‹å§‹è·¯ç”±è¿½è¹¤åˆ†æ...', 'info');
            
            const statsDiv = document.getElementById('monitoringStats');
            statsDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>ğŸ›£ï¸ è·¯ç”±è¿½è¹¤åˆ†æ</strong>
                </div>
                <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; padding: 15px; margin: 10px 0;">
                    <div style="color: #f59e0b; margin-bottom: 10px;">âš ï¸ ç€è¦½å™¨ç’°å¢ƒé™åˆ¶</div>
                    <div style="font-size: 0.9em;">
                        ç€è¦½å™¨ç’°å¢ƒç„¡æ³•åŸ·è¡ŒçœŸå¯¦çš„è·¯ç”±è¿½è¹¤ã€‚å»ºè­°åœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
                    </div>
                </div>
                
                <div style="background: rgba(0, 0, 0, 0.4); border-radius: 8px; padding: 15px; margin: 10px 0; font-family: monospace; font-size: 0.85em;">
                    <div style="margin-bottom: 10px; color: #64b3f4;"><strong>Windows:</strong></div>
                    <div>tracert google.com</div>
                    <div>tracert 8.8.8.8</div>
                    <br>
                    <div style="margin-bottom: 10px; color: #64b3f4;"><strong>macOS/Linux:</strong></div>
                    <div>traceroute google.com</div>
                    <div>traceroute 8.8.8.8</div>
                    <div>mtr google.com (éœ€å®‰è£ mtr)</div>
                </div>
                
                <div style="font-size: 0.85em; margin-top: 15px;">
                    <strong>è·¯ç”±è¿½è¹¤å¯ä»¥å¹«åŠ©è¨ºæ–·ï¼š</strong><br>
                    â€¢ ç¶²è·¯å»¶é²ä¾†æº<br>
                    â€¢ å°åŒ…éºå¤±ä½ç½®<br>
                    â€¢ ç¶²è·¯è·¯å¾‘å•é¡Œ<br>
                    â€¢ ISP è·¯ç”±å•é¡Œ
                </div>
            `;
            
            addLog('ğŸ›£ï¸ è·¯ç”±è¿½è¹¤åˆ†æèªªæ˜å·²é¡¯ç¤º', 'info');
        }

        // Ping æ¸¬è©¦æ‰€æœ‰ä¸»æ©Ÿ
        async function pingTestAll() {
            addLog('ğŸ“ é–‹å§‹ Ping æ¸¬è©¦æ‰€æœ‰ä¸»æ©Ÿ...', 'info');
            
            for (const host of hostsToMonitor) {
                try {
                    const startTime = performance.now();
                    const response = await fetch(host.url, {
                        method: 'HEAD',
                        signal: AbortSignal.timeout(5000),
                        mode: 'no-cors'
                    });
                    const endTime = performance.now();
                    const pingTime = Math.round(endTime - startTime);
                    
                    addLog(`ğŸ“ ${host.name}: ${pingTime}ms`, pingTime > 1000 ? 'warning' : 'success');
                } catch (error) {
                    addLog(`ğŸ“ ${host.name}: ç„¡æ³• Ping é€š`, 'error');
                }
            }
            
            addLog('ğŸ“ Ping æ¸¬è©¦å®Œæˆ', 'info');
        }

        // é€£æ¥åŸ æƒæï¼ˆç°¡åŒ–ç‰ˆï¼‰
        async function portScanAll() {
            addLog('ğŸ” é–‹å§‹é€£æ¥åŸ æƒæ...', 'info');
            
            const commonPorts = [80, 443, 22, 21, 25, 53, 110, 143, 993, 995];
            
            for (const host of hostsToMonitor) {
                if (host.url.startsWith('http')) {
                    try {
                        const url = new URL(host.url);
                        const hostname = url.hostname;
                        
                        addLog(`æƒæ ${host.name} (${hostname}) çš„å¸¸è¦‹é€£æ¥åŸ ...`, 'info');
                        
                        // æ³¨æ„ï¼šç€è¦½å™¨ç’°å¢ƒä¸­ç„¡æ³•çœŸæ­£é€²è¡Œé€£æ¥åŸ æƒæ
                        // é€™è£¡åªæ˜¯ç¤ºç¯„æ¦‚å¿µ
                        addLog(`âš ï¸ ç€è¦½å™¨ç’°å¢ƒç„¡æ³•é€²è¡ŒçœŸå¯¦é€£æ¥åŸ æƒæ`, 'warning');
                        addLog(`å»ºè­°ä½¿ç”¨ nmap æˆ–å…¶ä»–å·¥å…·: nmap ${hostname}`, 'info');
                        
                    } catch (error) {
                        addLog(`${host.name}: URL è§£æå¤±æ•—`, 'error');
                    }
                }
            }
            
            addLog('ğŸ” é€£æ¥åŸ æƒæèªªæ˜å®Œæˆ', 'info');
        }

        // DNS æŸ¥è©¢æ‰€æœ‰ä¸»æ©Ÿ
        async function dnsLookupAll() {
            addLog('ğŸŒ é–‹å§‹ DNS æŸ¥è©¢...', 'info');
            
            for (const host of hostsToMonitor) {
                if (host.url.startsWith('http')) {
                    try {
                        const url = new URL(host.url);
                        const hostname = url.hostname;
                        
                        // ç°¡å–®çš„ DNS æ¸¬è©¦ - å˜—è©¦è§£æåŸŸå
                        const startTime = performance.now();
                        const response = await fetch(`https://dns.google/resolve?name=${hostname}&type=A`, {
                            signal: AbortSignal.timeout(5000)
                        });
                        const endTime = performance.now();
                        const queryTime = Math.round(endTime - startTime);
                        
                        if (response.ok) {
                            const data = await response.json();
                            if (data.Answer && data.Answer.length > 0) {
                                const ips = data.Answer.filter(a => a.type === 1).map(a => a.data);
                                addLog(`ğŸŒ ${hostname}: ${ips.join(', ')} (${queryTime}ms)`, 'success');
                            } else {
                                addLog(`ğŸŒ ${hostname}: DNS æŸ¥è©¢ç„¡çµæœ`, 'warning');
                            }
                        } else {
                            addLog(`ğŸŒ ${hostname}: DNS æŸ¥è©¢å¤±æ•—`, 'error');
                        }
                        
                    } catch (error) {
                        addLog(`ğŸŒ ${host.name}: DNS æŸ¥è©¢éŒ¯èª¤ - ${error.message}`, 'error');
                    }
                }
            }
            
            addLog('ğŸŒ DNS æŸ¥è©¢å®Œæˆ', 'info');
        }

        // å¥åº·æª¢æŸ¥æ‰€æœ‰ä¸»æ©Ÿ
        async function healthCheckAll() {
            addLog('â¤ï¸ é–‹å§‹å¥åº·æª¢æŸ¥...', 'info');
            
            const healthResults = [];
            
            for (const host of hostsToMonitor) {
                const healthData = {
                    name: host.name,
                    url: host.url,
                    connectivity: false,
                    responseTime: null,
                    statusCode: null,
                    contentLength: null,
                    lastModified: null,
                    server: null
                };
                
                try {
                    const startTime = performance.now();
                    const response = await fetch(host.url, {
                        method: 'HEAD',
                        signal: AbortSignal.timeout(10000)
                    });
                    const endTime = performance.now();
                    
                    healthData.connectivity = true;
                    healthData.responseTime = Math.round(endTime - startTime);
                    healthData.statusCode = response.status;
                    healthData.contentLength = response.headers.get('content-length');
                    healthData.lastModified = response.headers.get('last-modified');
                    healthData.server = response.headers.get('server');
                    
                    const status = response.ok ? 'healthy' : 'warning';
                    addLog(`â¤ï¸ ${host.name}: ${status === 'healthy' ? 'å¥åº·' : 'ç•°å¸¸'} (${healthData.responseTime}ms, HTTP ${healthData.statusCode})`, status === 'healthy' ? 'success' : 'warning');
                    
                } catch (error) {
                    addLog(`â¤ï¸ ${host.name}: å¥åº·æª¢æŸ¥å¤±æ•— - ${error.message}`, 'error');
                }
                
                healthResults.push(healthData);
            }
            
            addLog('â¤ï¸ å¥åº·æª¢æŸ¥å®Œæˆ', 'info');
        }

        // è‡ªå‹•ä¿å­˜åŠŸèƒ½
        function autoSave() {
            const saveData = {
                hostsToMonitor,
                logEntries: logEntries.slice(-50), // åªä¿å­˜æœ€è¿‘50æ¢æ—¥èªŒ
                monitoringHistory,
                lastSaved: new Date().toISOString()
            };
            
            try {
                // æ³¨æ„ï¼šé€™è£¡ä¸èƒ½ä½¿ç”¨ localStorageï¼Œæ‰€ä»¥æˆ‘å€‘åªåœ¨å…§å­˜ä¸­ä¿å­˜
                window.hostMonitorSave = saveData;
                addLog('ğŸ’¾ é…ç½®å·²è‡ªå‹•ä¿å­˜åˆ°å…§å­˜', 'info');
            } catch (error) {
                addLog('âš ï¸ è‡ªå‹•ä¿å­˜å¤±æ•—', 'warning');
            }
        }

        // è‡ªå‹•åŠ è¼‰åŠŸèƒ½
        function autoLoad() {
            try {
                const saveData = window.hostMonitorSave;
                if (saveData && saveData.hostsToMonitor) {
                    hostsToMonitor = saveData.hostsToMonitor;
                    if (saveData.logEntries) {
                        logEntries = saveData.logEntries;
                    }
                    if (saveData.monitoringHistory) {
                        monitoringHistory = saveData.monitoringHistory;
                    }
                    addLog('ğŸ“‚ å·²åŠ è¼‰ä¹‹å‰çš„é…ç½®', 'success');
                    return true;
                }
            } catch (error) {
                addLog('âš ï¸ é…ç½®åŠ è¼‰å¤±æ•—', 'warning');
            }
            return false;
        }

        // å¿«é€Ÿè¨ºæ–·åŠŸèƒ½
        async function runQuickDiagnosis() {
            addLog('ğŸš€ é–‹å§‹å¿«é€Ÿè¨ºæ–·...', 'info');
            await monitorAllHosts();
            addLog('ğŸš€ å¿«é€Ÿè¨ºæ–·å®Œæˆ', 'success');
        }

        // æ‰¹é‡æ·»åŠ ä¸»æ©ŸåŠŸèƒ½
        function addBatchHosts() {
            const hostsInput = prompt('è«‹è¼¸å…¥è¦æ‰¹é‡æ·»åŠ çš„ä¸»æ©Ÿï¼Œç”¨æ›è¡Œåˆ†éš”\næ ¼å¼: URL|åç¨±|é¡å‹\nä¾‹å¦‚:\nhttps://example.com|ç¯„ä¾‹ç¶²ç«™|website\nhttp://192.168.1.1:8080|æœ¬åœ°æœå‹™|server');
            
            if (!hostsInput) return;
            
            const hostEntries = hostsInput.split('\n');
            let addedCount = 0;
            
            hostEntries.forEach(entry => {
                const parts = entry.trim().split('|');
                let hostUrl = parts[0] ? parts[0].trim() : '';
                let hostName = parts[1] ? parts[1].trim() : '';
                let hostType = parts[2] ? parts[2].trim() : 'website';
                
                if (!hostUrl) return;
                
                // è‡ªå‹•æ·»åŠ å”å®š
                if (!hostUrl.startsWith('http://') && !hostUrl.startsWith('https://')) {
                    if (hostUrl.includes(':') || /^\d+\.\d+\.\d+\.\d+/.test(hostUrl)) {
                        hostUrl = 'http://' + hostUrl;
                    } else {
                        hostUrl = 'https://' + hostUrl;
                    }
                }
                
                try {
                    const finalName = hostName || new URL(hostUrl).hostname;
                    
                    if (!hostsToMonitor.find(h => h.url === hostUrl)) {
                        hostsToMonitor.push({
                            url: hostUrl,
                            name: finalName,
                            type: hostType,
                            critical: false,
                            custom: true
                        });
                        addedCount++;
                    }
                } catch (error) {
                    addLog(`âŒ ç„¡æ•ˆçš„ URL: ${hostUrl}`, 'error');
                }
            });
            
            if (addedCount > 0) {
                initializeHostGrid();
                updateStats();
                addLog(`âœ… æ‰¹é‡æ·»åŠ äº† ${addedCount} å€‹ä¸»æ©Ÿ`, 'success');
            } else {
                addLog('âŒ æ²’æœ‰æœ‰æ•ˆçš„ä¸»æ©Ÿè¢«æ·»åŠ ', 'error');
            }
        }

        // é é¢è¼‰å…¥åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // å˜—è©¦åŠ è¼‰ä¹‹å‰çš„é…ç½®
            const loaded = autoLoad();
            
            initializeHostGrid();
            updateStats();
            addLog('ğŸŒ ä¸»æ©Ÿç›£æ§å·¥å…·å·²æº–å‚™å°±ç·’', 'success');
            addLog('ğŸš€ åŠŸèƒ½: è‡ªè¨‚ä¸»æ©Ÿã€è‡ªå‹•é‡æ–°æ•´ç†ã€SSLæª¢æŸ¥ã€å»¶é²æ¸¬è©¦', 'info');
            
            if (loaded) {
                addLog('ğŸ“‚ å·²æ¢å¾©ä¹‹å‰çš„é…ç½®å’Œéƒ¨åˆ†æ—¥èªŒ', 'info');
            }
            
            addLog('ğŸ’¡ æç¤º: ä½¿ç”¨ Ctrl+Enter å¿«é€Ÿç›£æ§ï¼ŒCtrl+E åŒ¯å‡ºæ—¥èªŒ', 'info');
            addLog('é»æ“Š"æª¢æ¸¬æ‰€æœ‰ä¸»æ©Ÿ"é–‹å§‹ç›£æ§', 'info');
            
            // æ·»åŠ é€²éšæ§åˆ¶ç•Œé¢
            setTimeout(addAdvancedControls, 500);
            
            // è¨­ç½®è‡ªå‹•ä¿å­˜ï¼ˆæ¯30ç§’ï¼‰
            setInterval(autoSave, 30000);
            
            // è‡ªå‹•é–‹å§‹å¿«é€Ÿè¨ºæ–·
            setTimeout(runQuickDiagnosis, 2000);
        });

        // æ·»åŠ é€²éšæ§åˆ¶åŠŸèƒ½
        function addAdvancedControls() {
            const panel = document.querySelector('.panel');
            const advancedSection = document.createElement('div');
            advancedSection.style.cssText = `
                border-top: 1px solid rgba(100, 179, 244, 0.2);
                margin-top: 30px;
                padding-top: 25px;
            `;
            advancedSection.innerHTML = `
                <h4 style="margin-bottom: 15px; color: #64b3f4;">ğŸš€ é€²éšåŠŸèƒ½</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-info" onclick="addBatchHosts()" style="width: auto;">ğŸ“‹ æ‰¹é‡æ·»åŠ ä¸»æ©Ÿ</button>
                    <button class="btn btn-info" onclick="exportHostConfig()" style="width: auto;">ğŸ“¤ åŒ¯å‡ºé…ç½®</button>
                    <button class="btn btn-info" onclick="importHostConfig()" style="width: auto;">ğŸ“¥ åŒ¯å…¥é…ç½®</button>
                    <button class="btn btn-warning" onclick="generateDetailedReport()" style="width: auto;">ğŸ“„ ç”Ÿæˆå ±å‘Š</button>
                </div>
                <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
                    ğŸ’¡ å¿«æ·éµ: Ctrl+Enter (ç›£æ§) | Ctrl+E (åŒ¯å‡ºæ—¥èªŒ) | Ctrl+Shift+C (æ¸…ç©ºæ—¥èªŒ)
                </div>
            `;
            
            // æ’å…¥åˆ°æ—¥èªŒæ§åˆ¶å€åŸŸå‰é¢
            const logControlSection = document.querySelector('.log-control-section');
            logControlSection.parentNode.insertBefore(advancedSection, logControlSection);
        }

        // é é¢å¸è¼‰æ™‚ä¿å­˜ä¸¦åœæ­¢è‡ªå‹•ç›£æ§
        window.addEventListener('beforeunload', function() {
            autoSave();
            if (autoMonitorInterval) {
                clearInterval(autoMonitorInterval);
            }
        });

        // éµç›¤å¿«æ·éµæ”¯æ´
        document.addEventListener('keydown', function(e) {
            // Ctrl+Enter å¿«é€Ÿç›£æ§
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                monitorAllHosts();
                addLog('ğŸ”¥ ä½¿ç”¨å¿«æ·éµ Ctrl+Enter é–‹å§‹ç›£æ§', 'info');
            }
            
            // Ctrl+E åŒ¯å‡ºæ—¥èªŒ
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                exportLogs('txt');
                addLog('ğŸ”¥ ä½¿ç”¨å¿«æ·éµ Ctrl+E åŒ¯å‡ºæ—¥èªŒ', 'info');
            }
            
            // Ctrl+Shift+C æ¸…ç©ºæ—¥èªŒ
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                clearLogs();
            }
            
            // Enter éµåœ¨ä¸»æ©Ÿè¼¸å…¥æ¡†ä¸­æ·»åŠ ä¸»æ©Ÿ
            if (e.key === 'Enter' && (e.target.id === 'customHost' || e.target.id === 'customName')) {
                e.preventDefault();
                addCustomHost();
            }
        });

        // ä¿®å¾©æ–°å¢ä¸»æ©ŸåŠŸèƒ½
        function addCustomHost() {
            const hostInput = document.getElementById('customHost');
            const nameInput = document.getElementById('customName');
            const typeSelect = document.getElementById('hostType');
            
            if (!hostInput || !nameInput || !typeSelect) {
                addLog('âŒ æ‰¾ä¸åˆ°è¼¸å…¥å…ƒç´ ï¼Œè«‹é‡æ–°è¼‰å…¥é é¢', 'error');
                return;
            }
            
            let hostUrl = hostInput.value.trim();
            const hostName = nameInput.value.trim();
            const hostType = typeSelect.value;
            
            if (!hostUrl) {
                addLog('âŒ è«‹è¼¸å…¥ä¸»æ©Ÿåœ°å€', 'error');
                hostInput.focus();
                return;
            }
            
            // é©—è­‰å’Œæ¨™æº–åŒ– URL
            try {
                // è‡ªå‹•æ·»åŠ å”å®š
                if (!hostUrl.startsWith('http://') && !hostUrl.startsWith('https://')) {
                    // å¦‚æœåŒ…å«é€£æ¥åŸ æˆ–æ˜¯ IPï¼Œé è¨­ä½¿ç”¨ http
                    if (hostUrl.includes(':') && !hostUrl.includes('://')) {
                        hostUrl = 'http://' + hostUrl;
                    } else if (/^\d+\.\d+\.\d+\.\d+/.test(hostUrl)) {
                        hostUrl = 'http://' + hostUrl;
                    } else {
                        hostUrl = 'https://' + hostUrl;
                    }
                }
                
                // é©—è­‰ URL æœ‰æ•ˆæ€§
                const urlObj = new URL(hostUrl);
                const finalName = hostName || urlObj.hostname || urlObj.host;
                
                // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨
                if (hostsToMonitor.find(h => h.url === hostUrl)) {
                    addLog(`âš ï¸ ä¸»æ©Ÿ ${hostUrl} å·²åœ¨ç›£æ§åˆ—è¡¨ä¸­`, 'warning');
                    return;
                }
                
                // æ–°å¢åˆ°åˆ—è¡¨
                hostsToMonitor.push({
                    url: hostUrl,
                    name: finalName,
                    type: hostType,
                    critical: false,
                    custom: true
                });
                
                // æ¸…ç©ºè¼¸å…¥æ¡†
                hostInput.value = '';
                nameInput.value = '';
                typeSelect.selectedIndex = 0;
                
                // é‡æ–°åˆå§‹åŒ–ç¶²æ ¼å’Œæ›´æ–°çµ±è¨ˆ
                initializeHostGrid();
                updateStats();
                
                addLog(`âœ… å·²æ–°å¢ç›£æ§ä¸»æ©Ÿ: ${finalName} (${hostUrl})`, 'success');
                addLog(`ğŸ“Š ç›®å‰å…±ç›£æ§ ${hostsToMonitor.length} å€‹ä¸»æ©Ÿ`, 'info');
                
                // è‡ªå‹•æ¸¬è©¦æ–°æ·»åŠ çš„ä¸»æ©Ÿ
                setTimeout(() => {
                    testHost({ url: hostUrl, name: finalName, type: hostType });
                }, 500);
                
            } catch (error) {
                addLog(`âŒ ç„¡æ•ˆçš„ä¸»æ©Ÿåœ°å€: ${hostUrl} - ${error.message}`, 'error');
                hostInput.focus();
            }
        }

        // æ”¹é€²ç§»é™¤ä¸»æ©ŸåŠŸèƒ½
        function removeCustomHost(url) {
            const index = hostsToMonitor.findIndex(h => h.url === url);
            if (index !== -1) {
                const removedHost = hostsToMonitor.splice(index, 1)[0];
                
                // åŒæ™‚æ¸…ç†æ­·å²è¨˜éŒ„
                if (monitoringHistory[url]) {
                    delete monitoringHistory[url];
                }
                
                // å¾ç›£æ§çµæœä¸­ç§»é™¤
                monitorResults = monitorResults.filter(r => r.url !== url);
                
                initializeHostGrid();
                updateStats();
                addLog(`âŒ å·²ç§»é™¤ç›£æ§ä¸»æ©Ÿ: ${removedHost.name}`, 'warning');
                addLog(`ğŸ“Š ç›®å‰å…±ç›£æ§ ${hostsToMonitor.length} å€‹ä¸»æ©Ÿ`, 'info');
            }
        }

        // æ”¹é€²çµ±è¨ˆæ›´æ–°åŠŸèƒ½
        function updateStats() {
            const totalHosts = hostsToMonitor.length;
            const onlineCount = monitorResults.filter(r => r.status === 'online').length;
            const offlineCount = monitorResults.filter(r => r.status === 'offline').length;
            const warningCount = monitorResults.filter(r => r.status === 'warning').length;
            
            // è¨ˆç®—å¹³å‡éŸ¿æ‡‰æ™‚é–“
            const onlineResults = monitorResults.filter(r => r.status === 'online' && r.responseTime);
            const avgResponseTime = onlineResults.length > 0 
                ? Math.round(onlineResults.reduce((sum, r) => sum + r.responseTime, 0) / onlineResults.length)
                : 0;

            // è¨ˆç®—ç¸½é«”å¯ç”¨æ€§
            const totalUptime = totalHosts > 0 ? Math.round((onlineCount / totalHosts) * 100) : 0;

            // æ›´æ–° DOM å…ƒç´ 
            const elements = {
                totalHosts: document.getElementById('totalHosts'),
                onlineHosts: document.getElementById('onlineHosts'),
                offlineHosts: document.getElementById('offlineHosts'),
                avgResponseTime: document.getElementById('avgResponseTime'),
                totalUptime: document.getElementById('totalUptime')
            };

            if (elements.totalHosts) elements.totalHosts.textContent = totalHosts;
            if (elements.onlineHosts) elements.onlineHosts.textContent = onlineCount;
            if (elements.offlineHosts) elements.offlineHosts.textContent = offlineCount;
            if (elements.avgResponseTime) elements.avgResponseTime.textContent = avgResponseTime;
            if (elements.totalUptime) elements.totalUptime.textContent = `${totalUptime}%`;
        }

        // åˆå§‹åŒ–æ™‚ç«‹å³æ›´æ–°çµ±è¨ˆ
        updateStats();
    </script>
</body>
</html>